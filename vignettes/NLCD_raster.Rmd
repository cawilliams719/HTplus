---
title: "NLCD Raster"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## NLCD
Robert Kennedyâ€™s LandTrendr, Landsat-based Detection of Trends in Disturbance and Recovery, is a dataset that includes land cover images from 1986 to 2018 for the version 2 product (Bartz et al., 2015). This data is also found in National Land Cover Database (NLCD). The LandTrendr dataset is stored as a GeoTIFF with a spatial resolution of 30 by 30 meters (Table 1). It is projected in North American Continental Albers and formatted as ENVI-header flat binary raster files (Table 1). The dataset is created from an algorithm that examines the annual change of individual pixels (Bartz et al., 2015; Kennedy et al., 2018). This algorithm condensed the time-series of pixel values into a string of segments to describe the temporal progression of each pixel (Bartz et al., 2015; Kennedy et al., 2018). LandTrendr removes the noise from seasonal variability of vegetation (Bartz et al., 2015). Without removing that variability, the data could infer vegetation changes when in fact they are seasonal changes in vegetation (Bartz et al., 2015). This algorithm removes that uncertainty. Land cover classes include open water (11), perennial ice/ snow (12), developed open space (21), developed low intensity (22), developed med intensity (23), developed high intensity (24), barren (31), deciduous forest (41), evergreen forest (42), mixed forest (43), dwarf scrub (51), shrubland (52), grassland (71), sedge (72), lichens (73), moss (74), pasture (81), rowcrops (82), woody wetlands (90), and emergent wetlands (95) (Kennedy et al., 2018).

## Download National Land Cover Dataset (NLCD)
The following code is used to iterate through NLCD data (downloaded from: ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/) .zip files. The for loop downloads each .zip file, unzips it, and deletes the original .zip file folder. This is accomplished for the years 2005 to 2014. The packages FedData, sp, utils, and raster are used.

```{r}
# Load Packages
library(FedData)
library(sp)
library(utils)
library(raster)

# NLCD urls for landcover vote data for 2005 to 2014
urls <- list("ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2005_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2006_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2007_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2008_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2009_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2010_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2011_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2012_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2013_vote.zip",
             "ftp://islay.ceoas.oregonstate.edu/cms/v1/landcover/vote/landcover_2014_vote.zip")

nlcd_dir <- "D:/data" # specify the file path for the output NLCD raster data output

# iterate through .zip files downloading landcover data for CONUS
for (i in urls) {
  tmp <- tempfile(tmpdir = nlcd_dir, fileext = ".zip")
  download.file(i, tmp)
  unzip(tmp,exdir = nlcd_dir)
  unlink(tmp)
  fp <- list.files(path = nlcd_dir, full.names = TRUE, pattern = "nlcd_vote")
  fp <- gsub("/", "\\\\", fp)
}
```
